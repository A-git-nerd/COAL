     1                                  ;it saves the screen clear it then restore it
     2                                  
     3                                  ; scroll up the screen
     4                                  [org 0x100]
     5                                  
     6 00000000 E92C10                  jmp start
     7                                  
     8 00000003 00<rep FA0h>            buffer: times 4000 db 0 ; space for 4000 bytes
     9                                  
    10 00000FA3 0A0D50726F6772616D-     message1: db 10, 13, 'Program started. $'
    10 00000FAC 20737461727465642E-
    10 00000FB5 2024               
    11 00000FB7 0A0D4D657373616765-     message2: db 10, 13, 'Message 22222... $'
    11 00000FC0 2032323232322E2E2E-
    11 00000FC9 2024               
    12 00000FCB 0A0D4D657373616765-     message3: db 10, 13, 'Message 3333... $'
    12 00000FD4 20333333332E2E2E20-
    12 00000FDD 24                 
    13                                  
    14                                  ;-------------------------------------------------------------------------------
    15 00000FDE 51                      sleep:                  push cx
    16 00000FDF B9FFFF                                          mov cx, 0xFFFF
    17 00000FE2 E2FE                    delay:                  loop delay
    18 00000FE4 59                                              pop cx
    19 00000FE5 C3                                              ret
    20                                  
    21                                  ;-------------------------------------------------------------------------------
    22                                  ; subroutine to clear the screen
    23                                  ;-------------------------------------------------------------------------------
    24 00000FE6 06                      clrscr:                 push es
    25 00000FE7 50                                              push ax
    26 00000FE8 57                                              push di
    27                                  
    28 00000FE9 B800B8                                          mov ax, 0xb800            ; point es to video base
    29 00000FEC 8EC0                                            mov es, ax
    30 00000FEE BF0000                                          mov di, 0                 ; point di to top left column
    31                                  
    32 00000FF1 26C7052007              nextloc:                mov word [es:di], 0x0720  ; clear next char on screen
    33 00000FF6 83C702                                          add di, 2                 ; move to next screen location
    34 00000FF9 81FFA00F                                        cmp di, 4000              ; has the whole screen cleared
    35 00000FFD 75F2                                            jne nextloc               ; if no clear next position
    36                                  
    37 00000FFF 5F                                              pop di
    38 00001000 58                                              pop ax
    39 00001001 07                                              pop es
    40 00001002 C3                                              ret
    41                                  
    42                                  ;-------------------------------------------------------------------------------
    43                                  ; subroutine to save the screen
    44                                  ;-------------------------------------------------------------------------------
    45 00001003 60                      saveScreen:             pusha
    46                                  
    47 00001004 B9A00F                                          mov cx, 4000              ; number of screen locations
    48 00001007 B800B8                                          mov ax, 0xb800
    49 0000100A 8ED8                                            mov ds, ax                ; ds = 0xb800
    50 0000100C 0E                                              push cs
    51 0000100D 07                                              pop es
    52                                  
    53 0000100E BE0000                                          mov si, 0
    54 00001011 BF[0300]                                        mov di, buffer
    55 00001014 FC                                              cld                        ; set auto increment mode
    56 00001015 F3A4                                            rep movsb                  ; save screen
    57                                  
    58 00001017 61                                              popa
    59 00001018 C3                                              ret
    60                                  
    61                                  ;-------------------------------------------------------------------------------
    62                                  ; subroutine to restore the screen
    63                                  ;-------------------------------------------------------------------------------
    64 00001019 60                      restoreScreen:          pusha
    65                                  
    66 0000101A B9A00F                                          mov cx, 4000              ; number of screen locations
    67 0000101D B800B8                                          mov ax, 0xb800
    68 00001020 8EC0                                            mov es, ax                ; es = 0xb800
    69 00001022 0E                                              push cs
    70 00001023 1F                                              pop ds
    71                                  
    72 00001024 BE[0300]                                        mov si, buffer
    73 00001027 BF0000                                          mov di, 0
    74 0000102A FC                                              cld                        ; set auto increment mode
    75 0000102B F3A4                                            rep movsb                  ; restore screen
    76                                  
    77 0000102D 61                                              popa
    78 0000102E C3                                              ret
    79                                  
    80                                  ;-------------------------------------------------------------------------------
    81                                  start:
    82 0000102F E8D1FF                                          call saveScreen
    83                                  
    84 00001032 B400                                            mov ah, 0
    85 00001034 CD16                                            int 0x16                  ; service 0 - get keystroke
    86                                  
    87 00001036 E8ADFF                                          call clrscr
    88 00001039 B400                                            mov ah, 0
    89 0000103B CD16                                            int 0x16                  ; service 0 - get keystroke
    90                                  
    91 0000103D E8D9FF                                          call restoreScreen
    92 00001040 B400                                            mov ah, 0
    93 00001042 CD16                                            int 0x16                  ; service 0 - get keystroke
    94                                  
    95 00001044 B8004C                                          mov ax, 0x4c00            ; terminate program
    96 00001047 CD21                                            int 0x21
